<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Voice Search GPT</title>
</head>
<body>

<p id="content">
  The Guyana Revenue Authority (GRA) is responsible for the administration of taxes, customs, and licensing services in Guyana. 
  Citizens can apply for a Taxpayer Identification Number (TIN) renew their driver's licenses, register vehicles, and 
  file income tax returns. GRA aims to provide efficient taxpayer services and improve compliance through modernization and technology.
</p>

<button onclick="startListening()">Speak</button>

<div id="result"></div>

<script>
async function searchContent(query) {
  const response = await fetch('/api/search', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ prompt: query })
  });
  const data = await response.json();
  return data.reply;
}

function startListening() {
  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'en-US';
  recognition.start();
  recognition.onresult = async (e) => {
    const query = e.results[0][0].transcript;
    const content = document.getElementById('content').innerText;
    const fullPrompt = `Only answer using the following text:\n"${content}"\nUser question: "${query}"`;
    const result = await searchContent(fullPrompt);
    document.getElementById('result').innerText = result;
  };
  recognition.onerror = (e) => {
    document.getElementById('result').innerText = 'Error: ' + e.error;
  };
}
</script>

</body>
</html>
